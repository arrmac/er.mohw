/*! grafana - v1.7.0 - 2014-08-16
 * Copyright (c) 2014 Torkel Ã–degaard; Licensed Apache License */

define(["angular","jquery","config","lodash","services/all"],function(a,b,c,d){var e=a.module("grafana.controllers");e.controller("DashCtrl",["$scope","$rootScope","dashboardKeybindings","filterSrv","dashboardSrv","dashboardViewStateSrv","panelMoveSrv","timer",function(a,b,e,f,g,h,i,j){a.editor={index:0},a.panelNames=c.panels,a.init=function(){a.availablePanels=c.panels,a.onAppEvent("setup-dashboard",a.setupDashboard)},a.setupDashboard=function(c,d){j.cancel_all(),b.performance.dashboardLoadStart=(new Date).getTime(),b.performance.panelsInitialized=0,b.performance.panelsRendered=0,a.dashboard=g.create(d),a.dashboardViewState=h.create(a),a.grafana.style=a.dashboard.style,a.filter=f,a.filter.init(a.dashboard);var k=i.create(a.dashboard);a.panelMoveDrop=k.onDrop,a.panelMoveStart=k.onStart,a.panelMoveStop=k.onStop,a.panelMoveOver=k.onOver,a.panelMoveOut=k.onOut,window.document.title="Grafana - "+a.dashboard.title,a.dashboard.refresh&&a.dashboard.set_interval(a.dashboard.refresh),e.shortcuts(a),a.emitAppEvent("dashboard-loaded",a.dashboard)},a.isPanel=function(a){return d.isNull(a)||d.isUndefined(a)||d.isUndefined(a.type)?!1:!0},a.add_row=function(a,b){a.rows.push(b)},a.add_row_default=function(){a.reset_row(),a.row.title="New row",a.add_row(a.dashboard,a.row)},a.reset_row=function(){a.row={title:"",height:"250px",editable:!0}},a.panel_path=function(a){return a?"app/panels/"+a.replace(".","/"):!1},a.edit_path=function(b){var c=a.panel_path(b);return c?c+"/editor.html":!1},a.setEditorTabs=function(b){return a.editorTabs=["General","Panel"],d.isUndefined(b.editorTabs)||(a.editorTabs=d.union(a.editorTabs,d.pluck(b.editorTabs,"title"))),a.editorTabs},a.init()}])});