/*! grafana - v1.7.0 - 2014-08-28
 * Copyright (c) 2014 Torkel Ã–degaard; Licensed Apache License */

define(["./helpers","angular","jquery","components/timeSeries","directives/grafanaGraph"],function(a,b,c,d){describe("grafanaGraph",function(){function a(a,e){describe(a,function(){var a={};a.setup=function(e){beforeEach(inject(function(f,g){var h=f.$new(),i=b.element("<div style='width:500px' grafana-graph><div>");h.height="200px",h.panel={legend:{},grid:{},y_formats:[],seriesOverrides:[]},h.dashboard={timezone:"browser"},h.range={from:new Date("2014-08-09 10:00:00"),to:new Date("2014-09-09 13:00:00")},a.data=[],a.data.push(new d({datapoints:[[1,1],[2,2]],info:{alias:"series1",enable:!0}})),a.data.push(new d({datapoints:[[1,1],[2,2]],info:{alias:"series2",enable:!0}})),e(h,a.data),g(i)(h),h.$digest(),c.plot=a.plotSpy=sinon.spy(),h.$emit("render",a.data),a.plotData=a.plotSpy.getCall(0).args[1],a.plotOptions=a.plotSpy.getCall(0).args[2]}))},e(a)})}beforeEach(module("grafana.directives")),a("simple lines options",function(a){a.setup(function(a){a.panel.lines=!0,a.panel.fill=5,a.panel.linewidth=3,a.panel.steppedLine=!0}),it("should configure plot with correct options",function(){expect(a.plotOptions.series.lines.show).to.be(!0),expect(a.plotOptions.series.lines.fill).to.be(.5),expect(a.plotOptions.series.lines.lineWidth).to.be(3),expect(a.plotOptions.series.lines.steps).to.be(!0)})}),a("grid thresholds 100, 200",function(a){a.setup(function(a){a.panel.grid={threshold1:100,threshold1Color:"#111",threshold2:200,threshold2Color:"#222"}}),it("should add grid markings",function(){var b=a.plotOptions.grid.markings;expect(b[0].yaxis.from).to.be(100),expect(b[0].yaxis.to).to.be(200),expect(b[0].color).to.be("#111"),expect(b[1].yaxis.from).to.be(200),expect(b[1].yaxis.to).to.be(1/0)})}),a("inverted grid thresholds 200, 100",function(a){a.setup(function(a){a.panel.grid={threshold1:200,threshold1Color:"#111",threshold2:100,threshold2Color:"#222"}}),it("should add grid markings",function(){var b=a.plotOptions.grid.markings;expect(b[0].yaxis.from).to.be(200),expect(b[0].yaxis.to).to.be(100),expect(b[0].color).to.be("#111"),expect(b[1].yaxis.from).to.be(100),expect(b[1].yaxis.to).to.be(-1/0)})}),a("series option overrides, fill & points",function(a){a.setup(function(a,b){a.panel.lines=!0,a.panel.fill=5,a.panel.seriesOverrides=[{alias:"test",fill:0,points:!0}],b[1].info.alias="test"}),it("should match second series and fill zero, and enable points",function(){expect(a.plotOptions.series.lines.fill).to.be(.5),expect(a.plotData[1].lines.fill).to.be(.001),expect(a.plotData[1].points.show).to.be(!0)})}),a("should order series order according to zindex",function(a){a.setup(function(a){a.panel.seriesOverrides=[{alias:"series1",zindex:2}]}),it("should move zindex 2 last",function(){expect(a.plotData[0].info.alias).to.be("series2"),expect(a.plotData[1].info.alias).to.be("series1")})})})});